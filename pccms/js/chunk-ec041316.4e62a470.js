(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-ec041316"],{"09d5":function(t,e,a){"use strict";a.r(e);var n=a("a34a"),i=a.n(n),r=a("365c"),o=a("333d"),s=a("575f"),l=a("4360");function c(t,e,a,n,i,r,o){try{var s=t[r](o),l=s.value}catch(t){return void a(t)}s.done?e(l):Promise.resolve(l).then(n,i)}function d(t){return function(){var e=this,a=arguments;return new Promise((function(n,i){var r=t.apply(e,a);function o(t){c(r,n,i,o,s,"next",t)}function s(t){c(r,n,i,o,s,"throw",t)}o(void 0)}))}}var u,m,p,f=[{id:0,name:"全部"},{id:1,name:"订餐就餐"},{id:2,name:"订餐未就餐"},{id:3,name:"未订餐就餐"},{id:4,name:"补录操作"}],g={components:{Pagination:o.a},data:function(){return{grade:l.a.getters.grade,company_id:"",canteen_id:"",formdata:{type:1},departmentList:[],dinnersList:[],locationList:[],companiesList:[],roleOptions:[],tableData:[{statistic:"股东",time_begin:"2019-10-11",time_end:"2019-11-30",department:"股东",dinnerStatistic:[{dinner_id:6,dinner:"中餐",order_count:"8",order_money:28},{dinner_id:5,dinner:"早餐",order_count:"2",order_money:4},{dinner_id:7,dinner:"晚餐",order_count:"5",order_money:3}]}],consumptionOptions:f,isDisabled:!0,current_page:1,size:10,total:0}},computed:{isAble:function(){return!!this.formdata.time_end&&!!this.formdata.time_begin},companiesVisible:function(){return 3!==this.grade}},watch:{isAble:function(t){this.isDisabled=!t}},created:function(){this.companiesVisible?this.getCompanies():(this.getLocationList(),this.getDepartmentListWithoutCid()),this.getRoleType()},methods:{getList:function(t){String(t).includes(",")?(this.departmentList=[{name:"全部"}],this.locationList=[{name:"全部"}],this.dinnersList=[{name:"全部"}],this.formdata.department_id="",this.formdata.canteen_id="",this.dinner_id=""):(this.getDepartmentList(t),this.getLocationList(t))},getCompanies:function(){var t=this;r.a.get("http://canteen.tonglingok.com/api/v1/admin/companies").then((function(e){var a=e.data,n=Object(s.b)(Object(s.a)(a));t.companiesList=n})).catch((function(t){return console.log(t)}))},getDinnersList:function(t){var e=this;t?r.a.get("http://canteen.tonglingok.com/api/v1/canteen/dinners?canteen_id=".concat(t)).then((function(t){e.dinnersList=Object(s.d)(Array.from(t.data))})).catch((function(t){return console.log(t)})):(this.formdata.dinner_id="",this.dinnersList=[{name:"全部"}])},getDepartmentListWithoutCid:(p=d(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.get("http://canteen.tonglingok.com/api/v1/admin/departments");case 2:"ok"===(e=t.sent).msg&&(this.departmentList=Object(s.d)(Aarray.from(e.data)));case 4:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)}),getDepartmentList:function(t){var e=this;t&&Number(t)&&r.a.get("v1/departments?c_id=".concat(t)).then((function(t){var a=t.data,n=Object(s.d)(Object(s.a)(a));e.departmentList=n})).catch((function(t){return console.log(t)}))},getLocationList:function(t){var e=this;t&&Number(t)?r.a.get("http://canteen.tonglingok.com/api/v1/canteens?company_id=".concat(t)).then((function(t){e.locationList=Object(s.d)(Array.from(t.data))})).catch((function(t){return console.log(t)})):r.a.get("http://canteen.tonglingok.com/api/v1/managerCanteens").then((function(t){e.locationList=Object(s.d)(Array.from(t.data))})).catch((function(t){return console.log(t)}))},getRoleType:(m=d(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.get("http://canteen.tonglingok.com/api/v1/role/types");case 2:"ok"===(e=t.sent).msg&&(this.roleOptions=Object(s.d)(e.data.data));case 4:case"end":return t.stop()}}),t,this)}))),function(){return m.apply(this,arguments)}),queryList:(u=d(i.a.mark((function t(e){var a,n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=e||1,a=this.formdata.type,t.next=4,r.a.get("http://canteen.tonglingok.com/api/v1/order/consumptionStatistic?page=".concat(e,"&size=").concat(this.size),this.formdata);case 4:"ok"===(n=t.sent).msg&&(2===a?(this.tableData=Array.from(n.data.statistic.data),this.current_page=n.data.statistic.current_page,this.total=n.data.statistic.total):(this.tableData=Array.from(n.data.data),this.current_page=n.data.current_page,this.total=n.data.total));case 6:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)}),test:function(t){console.log(t)}}},h=(a("ce40"),a("2877")),b=Object(h.a)(g,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order-statistics"},[a("div",{staticClass:"nav-title"},[t._v("消费总报表")]),a("el-divider"),a("div",{staticClass:"main"},[a("div",{staticClass:"main-header"},[a("div",{staticClass:"select-title"},[a("el-form",{attrs:{inline:!0,model:t.formdata,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"开始"}},[a("el-date-picker",{attrs:{placeholder:"请选择时间","value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd",type:"datetime"},model:{value:t.formdata.time_begin,callback:function(e){t.$set(t.formdata,"time_begin",e)},expression:"formdata.time_begin"}})],1),a("el-form-item",{attrs:{label:"结束"}},[a("el-date-picker",{attrs:{placeholder:"请选择时间","value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd",type:"datetime"},model:{value:t.formdata.time_end,callback:function(e){t.$set(t.formdata,"time_end",e)},expression:"formdata.time_end"}})],1),t.companiesVisible?a("el-form-item",{attrs:{label:"公司"}},[a("el-select",{attrs:{placeholder:"请选择公司"},on:{change:t.getList},model:{value:t.formdata.company_ids,callback:function(e){t.$set(t.formdata,"company_ids",e)},expression:"formdata.company_ids"}},t._l(t.companiesList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1):t._e(),a("el-form-item",{attrs:{label:"消费地点"}},[a("el-select",{attrs:{placeholder:"请选择饭堂"},on:{change:t.getDinnersList},model:{value:t.formdata.canteen_id,callback:function(e){t.$set(t.formdata,"canteen_id",e)},expression:"formdata.canteen_id"}},t._l(t.locationList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),t.companiesVisible?a("el-form-item",{attrs:{label:"部门"}},[a("el-select",{attrs:{placeholder:"请选择部门"},model:{value:t.formdata.department_id,callback:function(e){t.$set(t.formdata,"department_id",e)},expression:"formdata.department_id"}},t._l(t.departmentList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1):t._e(),a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:t.formdata.username,callback:function(e){t.$set(t.formdata,"username",e)},expression:"formdata.username"}})],1),a("el-form-item",{attrs:{label:"消费类型"}},[a("el-select",{model:{value:t.formdata.status,callback:function(e){t.$set(t.formdata,"status",e)},expression:"formdata.status"}},t._l(t.consumptionOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"人员类型"}},[a("el-select",{model:{value:t.formdata.staff_type_id,callback:function(e){t.$set(t.formdata,"staff_type_id",e)},expression:"formdata.staff_type_id"}},t._l(t.roleOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("el-form-item",{staticClass:"types-radio"},[a("el-radio-group",{on:{change:function(e){return t.queryList(t.current_page)}},model:{value:t.formdata.type,callback:function(e){t.$set(t.formdata,"type",e)},expression:"formdata.type"}},[a("el-radio",{attrs:{label:1}},[t._v("按部门汇总")]),a("el-radio",{attrs:{label:2}},[t._v("按姓名汇总")]),a("el-radio",{attrs:{label:3}},[t._v("按人员类型汇总")]),a("el-radio",{attrs:{label:4}},[t._v("按消费地点汇总")]),a("el-radio",{attrs:{label:5}},[t._v("按消费类型汇总")])],1)],1)],1)],1),a("div",{staticClass:"btn-area"},[a("el-button",{attrs:{type:"primary",disabled:t.isDisabled},on:{click:t.queryList}},[t._v("查询")]),a("el-button",{attrs:{type:"primary"}},[t._v("导出")])],1)]),a("div",{staticClass:"main-content"},[a("el-table",{attrs:{data:t.tableData,border:""}},[2===t.formdata.type?a("el-table-column",{attrs:{type:"expand"}},[a("el-table",{attrs:{size:"mini",data:t.tableData.dinner_statstic}},[a("el-table-column",{attrs:{label:"餐次信息"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{domProps:{innerHTML:t._s(t.showCellData(e.row.dinner))}})}}],null,!1,1006686396)}),a("el-table-column",{attrs:{label:"订餐数量"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{domProps:{innerHTML:t._s(t.showCellData(e.row.order_count))}})}}],null,!1,4292381684)}),a("el-table-column",{attrs:{label:"金额"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{domProps:{innerHTML:t._s(t.showCellData(e.row.order_money))}})}}],null,!1,766689127)})],1)],1):t._e(),a("el-table-column",{attrs:{label:"统计变量"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{domProps:{innerHTML:t._s(t.showCellData(e.row.statistic))}})}}])}),a("el-table-column",{attrs:{label:"开始时间"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{domProps:{innerHTML:t._s(t.showCellData(e.row.time_begin))}})}}])}),a("el-table-column",{attrs:{label:"结束时间"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{domProps:{innerHTML:t._s(t.showCellData(e.row.time_end))}})}}])}),a("el-table-column",{attrs:{label:"姓名"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{domProps:{innerHTML:t._s(t.showCellData(e.row.username))}})}}])}),a("el-table-column",{attrs:{label:"部门"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{domProps:{innerHTML:t._s(t.showCellData(e.row.department))}})}}])})],1),a("pagination",{attrs:{total:t.total,pageSize:t.size,currentPage:t.current_page},on:{pagination:t.queryList}})],1)])],1)}),[],!1,null,"4cb8689f",null);e.default=b.exports},"2f0c":function(t,e,a){"use strict";var n=a("7361");a.n(n).a},"333d":function(t,e,a){"use strict";var n={name:"Pagination",props:{small:{type:Boolean,default:!1},total:{required:!0,type:Number},page:{type:Number,default:1},background:{type:Boolean,default:!0},layout:{type:String,default:"prev, pager, next"},pageSize:{type:Number,default:10}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}}},methods:{handleClickPage:function(t){this.$emit("pagination",t)}}},i=(a("2f0c"),a("2877")),r=Object(i.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{small:t.small,background:t.background,total:t.total,layout:t.layout,"page-size":t.pageSize,"current-page":t.currentPage},on:{"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.handleClickPage}})],1)}),[],!1,null,null,null);e.a=r.exports},"3a72b":function(t,e,a){},7361:function(t,e,a){},ce40:function(t,e,a){"use strict";var n=a("3a72b");a.n(n).a}}]);
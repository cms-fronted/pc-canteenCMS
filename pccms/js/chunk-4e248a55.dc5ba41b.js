(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4e248a55"],{"2f0c":function(t,e,a){"use strict";var i=a("7361");a.n(i).a},"333d":function(t,e,a){"use strict";var i={name:"Pagination",props:{small:{type:Boolean,default:!1},total:{required:!0,type:Number},page:{type:Number,default:1},background:{type:Boolean,default:!0},layout:{type:String,default:"prev, pager, next"},pageSize:{type:Number,default:10}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}}},methods:{handleClickPage:function(t){this.$emit("pagination",t)}}},n=(a("2f0c"),a("2877")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{small:t.small,background:t.background,total:t.total,layout:t.layout,"page-size":t.pageSize,"current-page":t.currentPage},on:{"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.handleClickPage}})],1)}),[],!1,null,null,null);e.a=o.exports},"448e":function(t,e,a){},7361:function(t,e,a){},7672:function(t,e,a){"use strict";var i=a("448e");a.n(i).a},e548:function(t,e,a){"use strict";a.r(e);var i=a("365c"),n={props:{visible:{type:Boolean},editData:Object,companiesVisible:Boolean},data:function(){return{isOpen:this.visible,companyList:[],formdata:{}}},watch:{visible:function(t){this.formdata=Object.assign({},this.formdata,this.editData),this.isOpen=t}},created:function(){this.fetchCompanyList()},methods:{fetchCompanyList:function(){var t=this;i.a.get("http://canteen.tonglingok.com/api/v1/companies").then((function(e){t.companyList=Array.from(e.data.data)})).catch((function(t){return console.log(t)}))},handleClose:function(){this.$emit("close",!1),this.$refs.addForm.resetFields()},addSupplier:function(){var t=this;i.a.post("http://canteen.tonglingok.com/api/v1/supplier/save",this.formdata).then((function(e){t.$refs.addForm.resetFields(),t.$emit("close",!1,e.msg)})).catch((function(t){return console.log(t)}))}}},o=a("2877"),s=Object(o.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{visible:t.isOpen,title:"新增供应商"},on:{"update:visible":function(e){t.isOpen=e},close:t.handleClose}},[a("el-form",{ref:"addForm",attrs:{"label-width":"100px",model:t.formdata}},[t.companiesVisible?a("el-form-item",{attrs:{label:"公司"}},[a("el-select",{staticStyle:{width:"265px"},attrs:{placeholder:"请选择"},model:{value:t.formdata.c_id,callback:function(e){t.$set(t.formdata,"c_id",e)},expression:"formdata.c_id"}},t._l(t.companyList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1):t._e(),a("el-form-item",{attrs:{label:"供应商"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:t.formdata.name,callback:function(e){t.$set(t.formdata,"name",e)},expression:"formdata.name"}})],1),a("el-form-item",{attrs:{label:"账号"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:t.formdata.account,callback:function(e){t.$set(t.formdata,"account",e)},expression:"formdata.account"}})],1),a("el-form-item",{attrs:{label:"密码"}},[a("el-input",{attrs:{placeholder:"请输入",type:"password"},model:{value:t.formdata.pwd,callback:function(e){t.$set(t.formdata,"pwd",e)},expression:"formdata.pwd"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleClose}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.addSupplier}},[t._v("确 定")])],1)],1)}),[],!1,null,"39b71d5d",null).exports,l=a("333d"),c=a("4360"),r={data:function(){return{grade:c.a.getters.grade,company_id:"",companyList:[],supplierList:[],reviseSupplierForm:{id:"",name:"",account:"",pwd:""},addVisible:!1,reviseVisible:!1,currentSupplierId:"",page:1,total:0,editFormdata:{c_id:"",name:"",account:"",pwd:""},pwd:"",resetpwdVisible:!1}},components:{AddDialog:s,Pagination:l.a},created:function(){this.fetchCompanyList()},computed:{companiesVisible:function(){return 3!==this.grade}},methods:{fetchCompanyList:function(){var t=this;i.a.get("http://canteen.tonglingok.com/api/v1/companies").then((function(e){t.companyList=Array.from(e.data.data)})).catch((function(t){return console.log(t)}))},fetchSupplierList:function(){var t=this;this.companiesVisible?i.a.get("http://canteen.tonglingok.com/api/v1/suppliers?c_id=".concat(this.company_id,"&page=").concat(this.page,"&size=10")).then((function(e){t.supplierList=Array.from(e.data.data),t.total=e.data.total})).catch((function(t){return console.log(t)})):i.a.get("http://canteen.tonglingok.com/api/v1/suppliers?page=".concat(this.page,"&size=10")).then((function(e){t.supplierList=Array.from(e.data.data),t.total=e.data.total})).catch((function(t){return console.log(t)}))},showAddSupplier:function(){this.addVisible=!0},handleEdit:function(t){this.resetpwdVisible=!0;var e=t.id,a=t.name,i=t.account;this.reviseSupplierForm={id:e,name:a,account:i}},handleDelete:function(t){var e=this;this.currentSupplierId=t.id,this.$confirm("确定删除该供应商吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.a.post("http://canteen.tonglingok.com/api/v1/supplier/delete",{id:e.currentSupplierId}).then((function(t){e.fetchSupplierList(),e.sendMessage(t.msg)})).catch((function(t){return console.log(t)}))})).catch((function(t){}))},sendMessage:function(t){"ok"===t?this.$message({type:"success",message:"操作成功!"}):this.$message({type:"info",message:"操作失败"})},closeDialog:function(t,e){this.addVisible=t,"ok"===e&&(this.fetchSupplierList(),this.sendMessage(e))},getList:function(t){this.page=t,this.fetchSupplierList()},handleClick:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.addVisible=!0},handleClose:function(){this.pwd="",this.resetpwdVisible=!1},confirmReset:function(){var t=this;this.reviseSupplierForm.pwd=this.pwd,i.a.post("http://canteen.tonglingok.com/api/v1/supplier/update",this.reviseSupplierForm).then((function(e){t.resetpwdVisible=!1,t.pwd="",t.sendMessage(e.msg)})).catch((function(t){return console.log(t)}))}}},p=(a("7672"),Object(o.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"supplier"},[a("div",{staticClass:"nav-title"},[t._v("供应商管理")]),a("el-divider"),a("div",{staticClass:"main"},[a("div",{staticClass:"main-header"},[t.companiesVisible?a("span",{staticClass:"content-header"},[t._v("公司：")]):t._e(),t.companiesVisible?a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.company_id,callback:function(e){t.company_id=e},expression:"company_id"}},t._l(t.companyList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1):t._e(),a("el-button",{attrs:{type:"primary"},on:{click:t.fetchSupplierList}},[t._v("查询供应商")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleClick()}}},[t._v("增加供应商")])],1),a("div",{staticClass:"main-content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.supplierList}},[a("el-table-column",{attrs:{label:"公司名称",prop:"company"}}),a("el-table-column",{attrs:{label:"供应商",prop:"name"}}),a("el-table-column",{attrs:{label:"账号",prop:"account"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleDelete(e.row)}}},[t._v("Delete")]),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.handleEdit(e.row)}}},[t._v("重置密码")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>10,expression:"total > 10"}],attrs:{total:t.total,page:t.page},on:{"update:page":function(e){t.page=e},pagination:t.getList}})],1),a("add-dialog",{attrs:{visible:t.addVisible,editData:t.editFormdata,companiesVisible:t.companiesVisible},on:{close:t.closeDialog}}),a("el-dialog",{attrs:{title:"重置密码",visible:t.resetpwdVisible},on:{"update:visible":function(e){t.resetpwdVisible=e},close:t.handleClose}},[a("span",{staticClass:"content-header"},[t._v("密码：")]),a("el-input",{staticStyle:{width:"320px"},attrs:{placeholder:"请输入",type:"password"},model:{value:t.pwd,callback:function(e){t.pwd=e},expression:"pwd"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleClose}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.confirmReset}},[t._v("确 定")])],1)],1)],1)],1)])}),[],!1,null,null,null));e.default=p.exports}}]);
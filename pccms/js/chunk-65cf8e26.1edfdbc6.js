(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-65cf8e26"],{"0124":function(e,t,n){"use strict";n.r(t);var a=n("a34a"),r=n.n(a),i=n("365c"),o=(n("333d"),n("575f")),s=n("4360");function l(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t,n,a,r,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,r)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var i=e.apply(t,n);function o(e){c(i,a,r,o,s,"next",e)}function s(e){c(i,a,r,o,s,"throw",e)}o(void 0)}))}}var d,p,m,f,g,b,y={data:function(){return{grade:s.a.getters.grade,detailDialogVisible:!1,queryForm:{ordering_date:"",company_ids:null,dinner_id:"",canteen_id:"",used:3},tableData:[{order_id:8,money:"10.0",used:2,ordering_date:"2019-09-07",dinner:"中餐",canteen:"饭堂1",username:"张三",phone:"18956225230",province:"广东省",area:"蓬江区",city:"江门市",address:"江门市白石大道东4号路3栋"}],canteenOptions:[],companyOptions:[],dinnersOptions:[],detailForm:{id:8,address_id:1,d_id:6,type:2,create_time:"2019-09-09 16:34:15",hidden:2,foods:[{detail_id:5,o_id:8,food_id:1,count:1,name:"菜品1",price:"5.0"},{detail_id:6,o_id:8,food_id:3,count:1,name:"菜品2",price:"5.0"}],address:{id:1,province:"广东省",city:"江门市",area:"蓬江区",address:"江门市白石大道东4号路3栋",name:"张三",phone:"18956225230",sex:1}},total:0,size:10,current_page:1,isDisabled:!0}},computed:{isAble:function(){return!!this.queryForm.ordering_date&&!!this.queryForm.company_ids},companiesVisible:function(){return 3!==this.grade}},watch:{isAble:function(e){this.isDisabled=!e}},created:function(){this.companiesVisible?this.getCompanyOptions():this.getCanteenOptions()},methods:{getCompanyOptions:(b=u(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.get("http://canteen.tonglingok.com/api/v1/admin/companies");case 2:"ok"===(t=e.sent).msg&&(this.companyOptions=Object(o.b)(Object(o.a)(t.data)));case 4:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)}),getCanteenOptions:(g=u(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canteenOptions=[],this.dinnersOptions=[],this.queryForm.dinner_id=null,this.queryForm.canteen_id=null,!t){e.next=12;break}if(Number(t)){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,i.a.get("http://canteen.tonglingok.com/api/v1/canteens?company_id=".concat(t));case 9:n=e.sent,e.next=15;break;case 12:return e.next=14,i.a.get("http://canteen.tonglingok.com/api/v1/managerCanteens");case 14:n=e.sent;case 15:"ok"===n.msg&&(this.canteenOptions=Object(o.d)(Array.from(n.data)));case 16:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)}),getDinnersOptions:(f=u(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,i.a.get("http://canteen.tonglingok.com/api/v1/canteen/dinners?canteen_id=".concat(t));case 3:"ok"===(n=e.sent).msg&&(this.dinnersOptions=Object(o.d)(Array.from(n.data)));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)}),queryList:(m=u(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=JSON.parse(JSON.stringify(this.queryForm))).canteen_id=t.canteen_id?t.canteen_id:0,t.dinner_id=t.dinner_id?t.dinner_id:0,e.next=5,i.a.get("http://canteen.tonglingok.com/api/v1/order/takeoutStatistic?page=".concat(this.current_page,"&size=").concat(this.size),t);case 5:"ok"===(n=e.sent).msg&&(this.tableData=l(n.data.data),this.total=n.data.total,this.current_page=n.data.current_page);case 7:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)}),openDetailDialog:(p=u(r.a.mark((function e(t){var n,a,o=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.order_id,e.next=3,i.a.get("http://canteen.tonglingok.com/api/v1/order/info/print?order_id=".concat(n));case 3:"ok"===(a=e.sent).msg&&(this.detailForm=a.data,this.detailDialogVisible=!0,setTimeout((function(){o.$print(o.$refs.print)}),1e3));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)}),closeDetailDialog:(d=u(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.detailDialogVisible=!1;case 1:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})}},h=(n("f2a8"),n("2877")),_=Object(h.a)(y,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"takeout"},[n("div",{staticClass:"nav-title"},[e._v("外卖管理")]),n("el-divider"),n("div",{staticClass:"main"},[n("div",{staticClass:"main-header"},[n("el-form",{attrs:{model:e.queryForm,inline:!0}},[n("el-form-item",{attrs:{label:"日期"}},[n("el-date-picker",{staticStyle:{width:"140px"},attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd",type:"datetime"},model:{value:e.queryForm.ordering_date,callback:function(t){e.$set(e.queryForm,"ordering_date",t)},expression:"queryForm.ordering_date"}})],1),e.companiesVisible?n("el-form-item",{attrs:{label:"公司"}},[n("el-select",{attrs:{placeholder:"请选择公司"},on:{change:e.getCanteenOptions},model:{value:e.queryForm.company_ids,callback:function(t){e.$set(e.queryForm,"company_ids",t)},expression:"queryForm.company_ids"}},e._l(e.companyOptions,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),n("el-form-item",{attrs:{label:"饭堂"}},[n("el-select",{attrs:{placeholder:"请选择饭堂"},on:{change:e.getDinnersOptions},model:{value:e.queryForm.canteen_id,callback:function(t){e.$set(e.queryForm,"canteen_id",t)},expression:"queryForm.canteen_id"}},e._l(e.canteenOptions,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),n("el-form-item",{attrs:{label:"餐次"}},[n("el-select",{attrs:{placeholder:"请选择餐次"},model:{value:e.queryForm.dinner_id,callback:function(t){e.$set(e.queryForm,"dinner_id",t)},expression:"queryForm.dinner_id"}},e._l(e.dinnersOptions,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),n("el-form-item",{attrs:{label:"状态",prop:"used"}},[n("el-select",{model:{value:e.queryForm.used,callback:function(t){e.$set(e.queryForm,"used",t)},expression:"queryForm.used"}},[n("el-option",{attrs:{label:"全部",value:3}}),n("el-option",{attrs:{label:"已打印",value:1}}),n("el-option",{attrs:{label:"未打印",value:2}})],1)],1),n("el-button",{attrs:{type:"primary",disabled:e.isDisabled},on:{click:e.queryList}},[e._v("查询")]),n("el-button",{attrs:{type:"primary"}},[e._v("导出")])],1)],1),n("div",{staticClass:"main-content"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),n("el-table-column",{attrs:{label:"订单ID",prop:"order_id"}}),n("el-table-column",{attrs:{label:"日期",prop:"ordering_date"}}),n("el-table-column",{attrs:{label:"消费地点",prop:"canteen"}}),n("el-table-column",{attrs:{label:"用户名",prop:"username"}}),n("el-table-column",{attrs:{label:"手机号码",prop:"phone"}}),n("el-table-column",{attrs:{label:"餐次"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.openDetailDialog(t.row.dinner)}}},[e._v(e._s(t.row.dinner))])],1)]}}])}),n("el-table-column",{attrs:{label:"金额",prop:"money"}}),n("el-table-column",{attrs:{label:"送货地点","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v("\n              "+e._s(t.row.province+t.row.area+t.row.city+t.row.address)+"\n            ")])]}}])}),n("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tag",{attrs:{type:1===t.row.used?"success":"warning"}},[e._v("\n              "+e._s(1===t.row.used?"已派单":"未派单")+"\n            ")])]}}])}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[2===t.row.used?n("span",[n("el-button",{attrs:{type:"success"},on:{click:function(n){return e.openDetailDialog(t.row)}}},[e._v("打印小票")])],1):e._e()]}}])})],1),e.tableData?e._e():n("pagination",{attrs:{total:e.total,page:e.current_page},on:{pagination:e.queryList}})],1)]),n("el-dialog",{ref:"print",attrs:{visible:e.detailDialogVisible,width:"375px",title:"小票",center:"","show-close":!1,top:"5vh"},on:{"update:visible":function(t){e.detailDialogVisible=t},close:e.closeDetailDialog}},[n("ul",[n("li",[e._v("收货人："+e._s(e.detailForm.address.name))]),n("li",[e._v("手机号码："+e._s(e.detailForm.address.phone))]),n("li",[e._v("送货时间："+e._s(e.detailForm.address.name))]),n("li",[e._v("送货地址："+e._s(e.detailForm.address.province+e.detailForm.address.city+e.detailForm.address.area+e.detailForm.address.address))])]),n("p",{staticStyle:{textAlign:"center",fontSize:"18px"}},[e._v("订单明细")]),n("el-table",{attrs:{size:"mini",data:e.detailForm.foods}},[n("el-table-column",{attrs:{label:"菜品",prop:"name"}}),n("el-table-column",{attrs:{label:"数量",prop:"count"}}),n("el-table-column",{attrs:{label:"金额",prop:"price"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.price?t.row.price:"/")+"\n        ")]}}])})],1)],1)],1)}),[],!1,null,"cade95c0",null);t.default=_.exports},"2f0c":function(e,t,n){"use strict";var a=n("7361");n.n(a).a},"333d":function(e,t,n){"use strict";var a={name:"Pagination",props:{small:{type:Boolean,default:!1},total:{required:!0,type:Number},page:{type:Number,default:1},background:{type:Boolean,default:!0},layout:{type:String,default:"prev, pager, next"},pageSize:{type:Number,default:10}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}}},methods:{handleClickPage:function(e){this.$emit("pagination",e)}}},r=(n("2f0c"),n("2877")),i=Object(r.a)(a,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pagination-container"},[n("el-pagination",{attrs:{small:e.small,background:e.background,total:e.total,layout:e.layout,"page-size":e.pageSize,"current-page":e.currentPage},on:{"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.handleClickPage}})],1)}),[],!1,null,null,null);t.a=i.exports},7361:function(e,t,n){},b41e:function(e,t,n){},f2a8:function(e,t,n){"use strict";var a=n("b41e");n.n(a).a}}]);
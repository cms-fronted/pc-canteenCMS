(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-a0851902"],{"2f0c":function(t,e,a){"use strict";var n=a("7361");a.n(n).a},"333d":function(t,e,a){"use strict";var n={name:"Pagination",props:{small:{type:Boolean,default:!1},total:{required:!0,type:Number},page:{type:Number,default:1},background:{type:Boolean,default:!0},layout:{type:String,default:"prev, pager, next"},pageSize:{type:Number,default:10}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}}},methods:{handleClickPage:function(t){this.$emit("pagination",t)}}},r=(a("2f0c"),a("2877")),i=Object(r.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{small:t.small,background:t.background,total:t.total,layout:t.layout,"page-size":t.pageSize,"current-page":t.currentPage},on:{"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.handleClickPage}})],1)}),[],!1,null,null,null);e.a=i.exports},"5a6c":function(t,e,a){"use strict";a.r(e);var n=a("a34a"),r=a.n(n),i=a("333d"),o=a("365c"),s=a("575f"),l=a("4360");function c(t,e,a,n,r,i,o){try{var s=t[i](o),l=s.value}catch(t){return void a(t)}s.done?e(l):Promise.resolve(l).then(n,r)}function u(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var i=t.apply(e,a);function o(t){c(i,n,r,o,s,"next",t)}function s(t){c(i,n,r,o,s,"throw",t)}o(void 0)}))}}var p,m,d,f,g,y={components:{Pagination:i.a},computed:{companiesVisible:function(){return 3!==this.grade}},data:function(){return{grade:l.a.getters.grade,dialogVisible:!1,companyOptions:[],canteenOptions:[],dinnerOptions:[],tableData:[],queryForm:{company_id:"",canteen_id:""},updateForm:{},current_page:1,size:50,total:0}},created:function(){this.companiesVisible?this.getCompanies():this.getCanteenOptions(0)},methods:{getCompanies:(g=u(r.a.mark((function t(){var e;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.get("http://canteen.tonglingok.com/api/v1/admin/companies");case 2:"ok"===(e=t.sent).msg&&(this.companyOptions=Object(s.a)(e.data));case 4:case"end":return t.stop()}}),t,this)}))),function(){return g.apply(this,arguments)}),getCanteenOptions:(f=u(r.a.mark((function t(e){var a,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e||"",this.canteenOptions=[],this.queryForm.canteen_id="",!Number(a)){t.next=9;break}return t.next=6,o.a.get("http://canteen.tonglingok.com/api/v1/canteens?company_id=".concat(a));case 6:return"ok"===(n=t.sent).msg&&(this.canteenOptions=Array.from(n.data)),t.abrupt("return",n);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return f.apply(this,arguments)}),getDinnerOptions:(d=u(r.a.mark((function t(e){var a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.get("http://canteen.tonglingok.com/api/v1/canteen/dinners?canteen_id=".concat(e));case 2:"ok"===(a=t.sent).msg&&(this.dinnerOptions=Array.from(a.data));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return d.apply(this,arguments)}),queryList:(m=u(r.a.mark((function t(e){var a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=e||1,t.next=3,o.a.get("http://canteen.tonglingok.com/api/v1/order/materialsStatistic?page=".concat(e,"&size=").concat(this.size),this.queryForm);case 3:"ok"===(a=t.sent).msg&&(this.tableData=Array.from(a.data.list.data),this.total=a.data.list.total,this.current_page=a.data.list.current_page);case 5:case"end":return t.stop()}}),t,this)}))),function(t){return m.apply(this,arguments)}),createCell:function(){this.dialogVisible=!0},closeDialog:function(){this.dialogVisible=!1,this.updateForm.title=""},submitOrder:(p=u(r.a.mark((function t(){var e;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.updateForm=Object.assign({},this.updateForm,this.queryForm),this.updateForm.materials=JSON.stringify(this.tableData),console.log(this.updateForm),t.next=5,o.a.post("http://canteen.tonglingok.com/api/v1/order/material/update",this.updateForm);case 5:"ok"===(e=t.sent).msg?(this.queryForm={},this.tableData=[],this.closeDialog()):(this.closeDialog(),this.$message.error(e.msg));case 7:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)})}},b=(a("6cb7"),a("2877")),h=Object(b.a)(y,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order-material"},[a("div",{staticClass:"nav-title"},[t._v("材料明细下单表")]),a("el-divider"),a("div",{staticClass:"main"},[a("div",{staticClass:"main-header"},[a("el-form",{attrs:{inline:!0,model:t.queryForm}},[t.companiesVisible?a("el-form-item",{attrs:{label:"公司",prop:"company_id"}},[a("el-select",{on:{change:t.getCanteenOptions},model:{value:t.queryForm.company_id,callback:function(e){t.$set(t.queryForm,"company_id",e)},expression:"queryForm.company_id"}},t._l(t.companyOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1):t._e(),a("el-form-item",{attrs:{label:"消费地点",prop:"canteen_id"}},[a("el-select",{model:{value:t.queryForm.canteen_id,callback:function(e){t.$set(t.queryForm,"canteen_id",e)},expression:"queryForm.canteen_id"}},t._l(t.canteenOptions,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1)],1),a("el-form-item",{attrs:{label:"开始",prop:"time_begin"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd",type:"datetime"},model:{value:t.queryForm.time_begin,callback:function(e){t.$set(t.queryForm,"time_begin",e)},expression:"queryForm.time_begin"}})],1),a("el-form-item",{attrs:{label:"结束",prop:"time_end"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd",type:"datetime"},model:{value:t.queryForm.time_end,callback:function(e){t.$set(t.queryForm,"time_end",e)},expression:"queryForm.time_end"}})],1),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){return t.queryList(1)}}},[t._v("查询")]),a("el-button",{attrs:{type:"primary"}},[t._v("导出")]),a("el-button",{attrs:{type:"primary"},on:{click:t.createCell}},[t._v("提交")])],1)],1),a("div",{staticClass:"main-content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{type:"index",width:"50px"}}),a("el-table-column",{attrs:{label:"日期",prop:"ordering_date"}}),a("el-table-column",{attrs:{label:"餐次",prop:"dinner"}}),a("el-table-column",{attrs:{label:"材料名称",prop:"material"}}),a("el-table-column",{attrs:{label:"材料数量",prop:"order_count"}}),a("el-table-column",{attrs:{label:"订货数量",prop:"material_count"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{size:"mini",width:"50px"},model:{value:e.row.material_count,callback:function(a){t.$set(e.row,"material_count",a)},expression:"scoped.row.material_count"}})]}}])}),a("el-table-column",{attrs:{label:"单价",prop:"material_price"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{size:"mini",width:"50px"},model:{value:e.row.material_price,callback:function(a){t.$set(e.row,"material_price",a)},expression:"scoped.row.material_price"}})]}}])}),a("el-table-column",{attrs:{label:"总价"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.material_count*e.row.material_price))])]}}])})],1),a("pagination",{attrs:{total:t.total,currentPage:t.current_page,pageSize:t.size},on:{pagination:t.queryList}})],1)]),a("el-dialog",{attrs:{visible:t.dialogVisible,width:"30%",title:"报表名称"},on:{"update:visible":function(e){t.dialogVisible=e},close:t.closeDialog}},[a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"报表名称"}},[a("el-input",{model:{value:t.updateForm.title,callback:function(e){t.$set(t.updateForm,"title",e)},expression:"updateForm.title"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeDialog}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.submitOrder}},[t._v("确 定")])],1)],1)],1)}),[],!1,null,"d10e22b2",null);e.default=h.exports},"61f5":function(t,e,a){},"6cb7":function(t,e,a){"use strict";var n=a("61f5");a.n(n).a},7361:function(t,e,a){}}]);
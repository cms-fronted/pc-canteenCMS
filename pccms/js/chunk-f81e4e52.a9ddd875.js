(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-f81e4e52"],{"2f0c":function(t,e,a){"use strict";var n=a("7361");a.n(n).a},"333d":function(t,e,a){"use strict";var n={name:"Pagination",props:{small:{type:Boolean,default:!1},total:{required:!0,type:Number},page:{type:Number,default:1},background:{type:Boolean,default:!0},layout:{type:String,default:"prev, pager, next"},pageSize:{type:Number,default:10}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}}},methods:{handleClickPage:function(t){this.$emit("pagination",t)}}},i=(a("2f0c"),a("2877")),o=Object(i.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{small:t.small,background:t.background,total:t.total,layout:t.layout,"page-size":t.pageSize,"current-page":t.currentPage},on:{"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.handleClickPage}})],1)}),[],!1,null,null,null);e.a=o.exports},"422f":function(t,e,a){"use strict";var n=a("9ff2");a.n(n).a},7361:function(t,e,a){},"9ff2":function(t,e,a){},b400:function(t,e,a){"use strict";a.r(e);var n=a("365c"),i={props:{visible:{type:Boolean},title:{type:String,required:!0},editFormdata:{type:Object},type:{type:String},companiesVisible:{type:Boolean}},data:function(){return{isOpen:this.visible,companyList:[],formdata:{}}},watch:{visible:function(t){this.isOpen=t,this.formdata=Object.assign({},this.editFormdata)}},created:function(){this.fetchCompanyList()},methods:{sendPostRequest:function(t,e){var a=this;n.a.post(t,e).then((function(t){a.handleClose(),a.sendMessage(t.msg),a.$emit("confirm",t.msg)})).catch((function(t){return console.log(t)}))},sendMessage:function(t){"ok"===t?this.$message({type:"success",message:"操作成功!"}):this.$message({type:"info",message:"操作失败"})},fetchCompanyList:function(){var t=this;n.a.get("http://canteen.tonglingok.com/api/v1/companies").then((function(e){t.companyList=Array.from(e.data.data)})).catch((function(t){return console.log(t)}))},handleClose:function(){this.$emit("close",!1)},handleConfirm:function(){var t=this.formdata;if("_add"===this.type)this.sendPostRequest("http://canteen.tonglingok.com/api/v1/category/save",t),this.$refs.addGoodsForm.resetFields();else{var e=t.id,a=t.name;this.sendPostRequest("http://canteen.tonglingok.com/api/v1/category/update",{id:e,name:a}),this.$refs.addGoodsForm.resetFields()}}}},o=a("2877"),s=Object(o.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{visible:t.isOpen,title:t.title},on:{"update:visible":function(e){t.isOpen=e},close:t.handleClose}},[a("el-form",{ref:"addGoodsForm",attrs:{"label-width":"100px",model:t.formdata}},[t.companiesVisible?a("el-form-item",{attrs:{label:"公司"}},[a("el-select",{staticStyle:{width:"265px"},attrs:{placeholder:"请选择"},model:{value:t.formdata.c_id,callback:function(e){t.$set(t.formdata,"c_id",e)},expression:"formdata.c_id"}},t._l(t.companyList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1):t._e(),a("el-form-item",{attrs:{label:"商品类型"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:t.formdata.name,callback:function(e){t.$set(t.formdata,"name",e)},expression:"formdata.name"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleClose}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.handleConfirm}},[t._v("确 定")])],1)],1)}),[],!1,null,"7317e624",null).exports,c=a("333d"),l=a("4360"),r={data:function(){return{grade:l.a.getters.grade,companyList:[],company_id:"",tableList:[],currentGoodsId:"",total:0,page:1,visible:!1,editType:"",editFormdata:{},dialogTitle:""}},components:{Pagination:c.a,HandleDialog:s},created:function(){this.fetchCompanyList()},computed:{companiesVisible:function(){return 3!==this.grade}},methods:{fetchCompanyList:function(){var t=this;n.a.get("http://canteen.tonglingok.com/api/v1/companies").then((function(e){t.companyList=Array.from(e.data.data)})).catch((function(t){return console.log(t)}))},fetchTableList:function(){var t=this;this.companiesVisible?n.a.get("http://canteen.tonglingok.com/api/v1/categories?c_id=".concat(this.company_id,"&page=").concat(this.page,"&size=10")).then((function(e){t.tableList=Array.from(e.data.data),t.total=e.data.total})).catch((function(t){return console.log(t)})):n.a.get("http://canteen.tonglingok.com/api/v1/categories?page=".concat(this.page,"&size=10")).then((function(e){console.log(e),t.tableList=Array.from(e.data.data),t.total=e.data.total})).catch((function(t){return console.log(t)}))},handleDelete:function(t){var e=this;this.currentGoodsId=t.id,this.$confirm("确定删除该类型吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n.a.post("http://canteen.tonglingok.com/api/v1/category/delete",{id:e.currentGoodsId}).then((function(t){e.fetchTableList(),e.sendMessage(t.msg)})).catch((function(t){return console.log(t)}))})).catch((function(t){}))},sendMessage:function(t){"ok"===t?this.$message({type:"success",message:"操作成功!"}):this.$message({type:"info",message:"操作失败"})},getList:function(t){this.page=t,this.fetchTableList()},closeDialog:function(t){this.visible=t},confirmUpdate:function(t){"ok"===t&&this.fetchTableList()},handleClick:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;this.editFormdata={},this.visible=!0,this.dialogTitle=a,this.editType=e,Object.assign(this.editFormdata,{},t)}}},d=(a("422f"),Object(o.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"wechat"},[a("div",{staticClass:"nav-title"},[t._v("微信端设置")]),a("el-divider"),a("div",{staticClass:"main"},[a("div",{staticClass:"main-header"},[t.companiesVisible?a("span",{staticClass:"content-header"},[t._v("公司：")]):t._e(),t.companiesVisible?a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.company_id,callback:function(e){t.company_id=e},expression:"company_id"}},t._l(t.companyList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1):t._e(),a("el-button",{attrs:{type:"primary"},on:{click:t.fetchTableList}},[t._v("查询商品类型")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleClick({c_id:t.company_id},"_add","增加商品类型")}}},[t._v("增加商品类型")])],1),a("div",{staticClass:"main-content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.tableList}},[a("el-table-column",{attrs:{label:"公司名称",prop:"company"}}),a("el-table-column",{attrs:{label:"商品类型",prop:"name"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.handleClick(e.row,"_edit","更改商品类型")}}},[t._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleDelete(e.row)}}},[t._v("Delete")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>10,expression:"total > 10"}],attrs:{total:t.total,page:t.page},on:{"update:page":function(e){t.page=e},pagination:t.getList}})],1)])],1),a("handle-dialog",{attrs:{visible:t.visible,type:t.editType,editFormdata:t.editFormdata,title:t.dialogTitle,companiesVisible:t.companiesVisible},on:{close:t.closeDialog,confirm:t.confirmUpdate}})],1)}),[],!1,null,null,null));e.default=d.exports}}]);
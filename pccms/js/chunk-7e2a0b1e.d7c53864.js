(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7e2a0b1e"],{"04a7":function(e,t,a){"use strict";var n=a("eace");a.n(n).a},"2f0c":function(e,t,a){"use strict";var n=a("7361");a.n(n).a},"333d":function(e,t,a){"use strict";var n={name:"Pagination",props:{small:{type:Boolean,default:!1},total:{required:!0,type:Number},page:{type:Number,default:1},background:{type:Boolean,default:!0},layout:{type:String,default:"prev, pager, next"},pageSize:{type:Number,default:10}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}}},methods:{handleClickPage:function(e){this.$emit("pagination",e)}}},r=(a("2f0c"),a("2877")),i=Object(r.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{small:e.small,background:e.background,total:e.total,layout:e.layout,"page-size":e.pageSize,"current-page":e.currentPage},on:{"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.handleClickPage}})],1)}),[],!1,null,null,null);t.a=i.exports},7361:function(e,t,a){},e386:function(e,t,a){"use strict";a.r(t);var n=a("a34a"),r=a.n(n),i=a("365c"),o=a("2f62"),l=a("333d"),c=a("575f");function s(e,t,a,n,r,i,o){try{var l=e[i](o),c=l.value}catch(e){return void a(e)}l.done?t(c):Promise.resolve(c).then(n,r)}function u(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var i=e.apply(t,a);function o(e){s(i,n,r,o,l,"next",e)}function l(e){s(i,n,r,o,l,"throw",e)}o(void 0)}))}}function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function d(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var m,f,g,b,y,h={components:{Pagination:l.a},data:function(){return{detailVisible:!1,companyOptions:[],canteenOptions:[],queryForm:{},tableData:[],detailData:[],detailForm:{},current_page:1,size:10,total:0,detailTotal:0,detailSize:5,detailCurrentPage:1,checked_id:[]}},computed:function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(a,!0).forEach((function(t){d(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},Object(o.c)({role:function(e){return e.user.role},grade:function(e){return e.user.grade},token:function(e){return e.user.token}}),{companiesVisible:function(){return 3!==this.grade}}),created:function(){this.companiesVisible?this.getCompanies():this.getCanteenOptions(0)},methods:{getCompanies:(y=u(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.get("http://canteen.tonglingok.com/api/v1/admin/companies");case 2:"ok"===(t=e.sent).msg&&(this.companyOptions=Object(c.a)(t.data));case 4:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)}),getCanteenOptions:(b=u(r.a.mark((function e(t){var a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t||"",e.next=3,i.a.get("http://canteen.tonglingok.com/api/v1/canteens?company_id=".concat(a));case 3:return"ok"===(n=e.sent).msg&&(this.canteenOptions=Array.from(n.data)),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)}),queryList:(g=u(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||1,e.next=3,i.a.get("http://canteen.tonglingok.com/api/v1/order/material/reports?page=".concat(t,"&size=").concat(this.size),this.queryForm);case 3:"ok"===(a=e.sent).msg&&(this.tableData=Array.from(a.data.data),this.total=a.data.total,this.current_page=a.data.current_page);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)}),getDetailList:(f=u(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||1,e.next=3,i.a.get("http://canteen.tonglingok.com/api/v1/order/material/report?page=".concat(t,"&size=").concat(this.detailSize,"&id=").concat(this.detailForm.id));case 3:"ok"===(a=e.sent).msg&&(this.detailData=Array.from(a.data.list.data),this.detailTotal=a.data.list.total,this.detailCurrentPage=a.data.list.current_page),console.log(this.detailData);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)}),handleSelectionChange:function(e){console.log(e)},showDetail:(m=u(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),this.detailForm=Object.assign({},t),e.next=4,this.getDetailList();case 4:this.detailVisible=!0;case 5:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)}),closeDetailDialog:function(){this.detailForm={},this.detailData=[],this.detailVisible=!1},deleteDetail:function(e){var t=this,a=e.id;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(u(r.a.mark((function e(){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.post("http://canteen.tonglingok.com/api/v1/order/material/report/delete",{id:a});case 2:"ok"===(n=e.sent).msg?(t.$message.success("操作成功!"),t.queryList(t.current_page)):t.$message.error(n.msg);case 4:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)}))}}},v=(a("04a7"),a("2877")),_=Object(v.a)(h,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"material-storage"},[a("div",{staticClass:"nav-title"},[e._v("入库材料管理")]),a("el-divider"),a("div",{staticClass:"main"},[a("div",{staticClass:"main-header"},[a("el-form",{attrs:{inline:!0,model:e.queryForm}},[e.companiesVisible?a("el-form-item",{attrs:{label:"公司",prop:"company_id"}},[a("el-select",{on:{change:e.getCanteenOptions},model:{value:e.queryForm.company_id,callback:function(t){e.$set(e.queryForm,"company_id",t)},expression:"queryForm.company_id"}},e._l(e.companyOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),a("el-form-item",{attrs:{label:"消费地点",prop:"canteen_id"}},[a("el-select",{model:{value:e.queryForm.canteen_id,callback:function(t){e.$set(e.queryForm,"canteen_id",t)},expression:"queryForm.canteen_id"}},e._l(e.canteenOptions,(function(e){return a("el-option",{key:e.id,attrs:{value:e.id,label:e.name}})})),1)],1),a("el-form-item",{attrs:{label:"开始",prop:"time_begin"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd",type:"datetime"},model:{value:e.queryForm.time_begin,callback:function(t){e.$set(e.queryForm,"time_begin",t)},expression:"queryForm.time_begin"}})],1),a("el-form-item",{attrs:{label:"结束",prop:"time_end"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd",type:"datetime"},model:{value:e.queryForm.time_end,callback:function(t){e.$set(e.queryForm,"time_end",t)},expression:"queryForm.time_end"}})],1),a("el-button",{on:{click:function(t){return e.queryList(1)}}},[e._v("查询")])],1)],1),a("div",{staticClass:"main-content"},[a("el-table",{attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"序号",type:"index"}}),a("el-table-column",{attrs:{label:"消费地点"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.canteen.name))])]}}])}),a("el-table-column",{attrs:{label:"报表名称",prop:"title"}}),a("el-table-column",{attrs:{label:"生成时间",prop:"create_time"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showDetail(t.row)}}},[e._v("查询")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.deleteDetail(t.row)}}},[e._v("作废")])],1)]}}])})],1),a("pagination",{attrs:{total:e.total,currentPage:e.current_page,pageSize:e.size},on:{pagination:e.queryList}})],1)]),a("el-dialog",{attrs:{visible:e.detailVisible,title:"明细",center:"",width:"60%"},on:{"update:visible":function(t){e.detailVisible=t},close:e.closeDetailDialog}},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(e.detailForm.title))])]),a("el-table",{attrs:{data:e.detailData}},[a("el-table-column",{attrs:{type:"index",width:"50px"}}),a("el-table-column",{attrs:{label:"日期",prop:"ordering_date"}}),a("el-table-column",{attrs:{label:"餐次",prop:"dinner"}}),a("el-table-column",{attrs:{label:"材料名称",prop:"material"}}),a("el-table-column",{attrs:{label:"材料数量",prop:"order_count"}}),a("el-table-column",{attrs:{label:"订货数量",prop:"material_count"}}),a("el-table-column",{attrs:{label:"单价",prop:"material_price"}}),a("el-table-column",{attrs:{label:"总价"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.material_count*t.row.material_price))])]}}])})],1),a("pagination",{attrs:{total:e.detailTotal,pageSize:e.detailSize,current_page:e.detailCurrentPage},on:{pagination:e.getDetailList}})],1)],1)],1)}),[],!1,null,"5045ecf4",null);t.default=_.exports},eace:function(e,t,a){}}]);
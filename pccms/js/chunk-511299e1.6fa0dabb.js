(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-511299e1"],{"0196":function(t,e,a){"use strict";a.r(e);var n=a("a34a"),i=a.n(n),r=a("365c"),o=a("575f"),s=a("4360"),l=a("333d");function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e,a,n,i,r,o){try{var s=t[r](o),l=s.value}catch(t){return void a(t)}s.done?e(l):Promise.resolve(l).then(n,i)}function u(t){return function(){var e=this,a=arguments;return new Promise((function(n,i){var r=t.apply(e,a);function o(t){d(r,n,i,o,s,"next",t)}function s(t){d(r,n,i,o,s,"throw",t)}o(void 0)}))}}var p,m,f,g,b,h=[{id:0,name:"全部"},{id:1,name:"已完成"},{id:2,name:"未完成"},{id:3,name:"待取货"},{id:4,name:"已取货"}],y={components:{Pagination:l.a},data:function(){return{fullscreenLoading:!1,grade:s.a.getters.grade,isPrint:!1,detailDialogVisible:!1,companyList:[],departmentList:[],goodStateOptions:h,formdata:{},tableData:[{order_id:6,create_time:"2019-09-28 08:14:10",used_time:null,username:"LANGBIN",phone:"15521323081",order_count:2,money:10,address_id:1,address:{id:1,address:"江门市白石大道东4号路3栋"}}],detailForm:{products:[{category:"111",name:"11111",price:"1111",unit:"11111",count:"111"}]},isDisabled:!0,current_page:1,size:10,total:0}},watch:{isAble:function(t){this.isDisabled=!t}},computed:{companiesVisible:function(){return 3!==this.grade},isAble:function(){return!!this.formdata.time_end&&!!this.formdata.time_begin},dialogTitle:function(){return this.isPrint?"小票":"订单明细"}},created:function(){this.companiesVisible?this.getCompanies():this.getDepartmentListWithoutCid(),r.a.get("http://canteen.tonglingok.com/api/v1/order/detail?id=8&type=1").then((function(t){return console.log(t)}))},methods:{tableRowClassName:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return"table-border"},getCompanies:function(){var t=this;r.a.get("http://canteen.tonglingok.com/api/v1/admin/companies").then((function(e){var a=e.data,n=Object(o.a)(a);t.companyList=n})).catch((function(t){return console.log(t)}))},getDepartmentList:(b=u(i.a.mark((function t(e){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.get("v1/departments?c_id=".concat(e));case 2:"ok"===(a=t.sent).msg&&(this.departmentList=Object(o.d)(Array.from(Object(o.a)(a.data))));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return b.apply(this,arguments)}),getDepartmentListWithoutCid:(g=u(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.get("http://canteen.tonglingok.com/api/v1/admin/departments");case 2:"ok"===(e=t.sent).msg&&(this.departmentList=Object(o.d)(Aarray.from(e.data)));case 4:case"end":return t.stop()}}),t,this)}))),function(){return g.apply(this,arguments)}),fetchList:(f=u(i.a.mark((function t(e){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=c(e)===Number?e:1,t.next=3,r.a.get("http://canteen.tonglingok.com/api/v1/shop/order/statistic/manager?page=".concat(e,"&size=").concat(this.size),this.formdata);case 3:"ok"===(a=t.sent).msg&&(this.tableData=Array.from(a.data.data),this.total=a.data.total,this.current_page=a.data.current_page);case 5:case"end":return t.stop()}}),t,this)}))),function(t){return f.apply(this,arguments)}),closeDetailDialog:function(){this.detailDialogVisible=!1,this.isPrint=!1,this.detailForm={}},checkDetail:(m=u(i.a.mark((function t(e){var a,n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.order_id,t.next=3,r.a.get("http://canteen.tonglingok.com/api/v1/shop/order/products?order_id=".concat(a));case 3:"ok"===(n=t.sent).msg&&(this.detailForm=Object.assign({},n.data),this.detailDialogVisible=!0);case 5:case"end":return t.stop()}}),t,this)}))),function(t){return m.apply(this,arguments)}),print:(p=u(i.a.mark((function t(e){var a,n,o=this;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isPrint=!0,a=e.order_id,t.next=4,r.a.get("http://canteen.tonglingok.com/api/v1/shop/order/products?order_id=".concat(a));case 4:"ok"===(n=t.sent).msg&&(this.detailForm=Object.assign({},n.data),this.detailDialogVisible=!0),this.fullscreenLoading=!0,setTimeout((function(){o.fullscreenLoading=!1,o.$print(o.$refs.detail,{noPrint:".el-button"})}),1e3);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return p.apply(this,arguments)}),deriveData:function(){console.log("点击导出表格")}}},v=(a("2e4b"),a("2877")),_=Object(v.a)(y,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"shop-order-detail-manager"},[a("div",{staticClass:"nav-title"},[t._v("订单明细查询")]),a("el-divider"),a("div",{staticClass:"main"},[a("div",{staticClass:"main-header"},[a("div",{staticClass:"select-title"},[a("el-form",{attrs:{model:t.formdata,inline:!0}},[a("el-form-item",{attrs:{label:"开始"}},[a("el-date-picker",{staticStyle:{width:"220px"},attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd",type:"datetime"},model:{value:t.formdata.time_begin,callback:function(e){t.$set(t.formdata,"time_begin",e)},expression:"formdata.time_begin"}})],1),a("el-form-item",{attrs:{label:"结束"}},[a("el-date-picker",{staticStyle:{width:"220px"},attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd",type:"datetime"},model:{value:t.formdata.time_end,callback:function(e){t.$set(t.formdata,"time_end",e)},expression:"formdata.time_end"}})],1),t.companiesVisible?a("el-form-item",{attrs:{label:"公司"}},[a("el-select",{attrs:{placeholder:"请选择企业"},on:{change:t.getDepartmentList},model:{value:t.formdata.company_id,callback:function(e){t.$set(t.formdata,"company_id",e)},expression:"formdata.company_id"}},t._l(t.companyList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1):t._e(),a("el-form-item",{attrs:{label:"部门"}},[a("el-select",{attrs:{placeholder:"请选择部门"},model:{value:t.formdata.department_id,callback:function(e){t.$set(t.formdata,"department_id",e)},expression:"formdata.department_id"}},t._l(t.departmentList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{attrs:{placeholder:"请选择状态"},model:{value:t.formdata.status,callback:function(e){t.$set(t.formdata,"status",e)},expression:"formdata.status"}},t._l(t.goodStateOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1)],1),a("div",{staticClass:"btn-area"},[a("el-button",{attrs:{type:"primary",disabled:t.isDisabled},on:{click:t.fetchList}},[t._v("查询")]),a("el-button",{attrs:{type:"primary"},on:{click:t.deriveData}},[t._v("导出")])],1)]),a("div",{staticClass:"main-content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50px"}}),a("el-table-column",{attrs:{label:"下单时间"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{domProps:{innerHTML:t._s(t.showCellData(e.row.create_time))}})}}])}),a("el-table-column",{attrs:{label:"结束时间"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{domProps:{innerHTML:t._s(t.showCellData(e.row.used_time))}})}}])}),a("el-table-column",{attrs:{label:"姓名"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{domProps:{innerHTML:t._s(t.showCellData(e.row.username))}})}}])}),a("el-table-column",{attrs:{label:"手机号码"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{domProps:{innerHTML:t._s(t.showCellData(e.row.phone))}})}}])}),a("el-table-column",{attrs:{label:"商品数量"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{domProps:{innerHTML:t._s(t.showCellData(e.row.order_count))}})}}])}),a("el-table-column",{attrs:{label:"商品金额(元)"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{domProps:{innerHTML:t._s(t.showCellData(e.row.money))}})}}])}),a("el-table-column",{attrs:{label:"地址"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.address?e.row.address.address:"/"))])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.checkDetail(e.row)}}},[t._v("明细")]),a("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"text"},on:{click:function(a){return t.print(e.row)}}},[t._v("打印")])],1)]}}])})],1),a("pagination",{attrs:{total:t.total,pageSize:t.size,currentPage:t.current_page},on:{pagination:t.fetchList}})],1)]),a("el-dialog",{ref:"detail",attrs:{visible:t.detailDialogVisible,width:"520px",title:t.dialogTitle,center:"","show-close":!1,top:"5vh"},on:{"update:visible":function(e){t.detailDialogVisible=e},close:t.closeDetailDialog}},[a("ul",[t.isPrint?a("li",[t._v("收货人："+t._s(t.detailForm.address.name))]):t._e(),t.isPrint?a("li",[t._v("手机号码："+t._s(t.detailForm.address.phone))]):t._e(),t.isPrint?a("li",[t._v("\n        送货地址："+t._s(t.detailForm.address.province+t.detailForm.address.city+t.detailForm.address.area+t.detailForm.address.address)+"\n      ")]):t._e()]),t.isPrint?a("p",{staticStyle:{textAlign:"center"}},[t._v("订单明细")]):t._e(),a("el-table",{attrs:{size:"mini",data:t.detailForm.products,"cell-class-name":t.tableRowClassName,"header-cell-class-name":t.tableRowClassName}},[a("el-table-column",{attrs:{label:"类型",prop:"category"}}),a("el-table-column",{attrs:{label:"名称",prop:"name"}}),a("el-table-column",{attrs:{label:"单位",prop:"unit"}}),a("el-table-column",{attrs:{label:"数量",prop:"count"}}),a("el-table-column",{attrs:{label:"金额",prop:"price"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{domProps:{innerHTML:t._s(t.showCellData(e.row.price))}})}}])})],1)],1)],1)}),[],!1,null,null,null);e.default=_.exports},"2e4b":function(t,e,a){"use strict";var n=a("7e93");a.n(n).a},"2f0c":function(t,e,a){"use strict";var n=a("7361");a.n(n).a},"333d":function(t,e,a){"use strict";var n={name:"Pagination",props:{small:{type:Boolean,default:!1},total:{required:!0,type:Number},page:{type:Number,default:1},background:{type:Boolean,default:!0},layout:{type:String,default:"prev, pager, next"},pageSize:{type:Number,default:10}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}}},methods:{handleClickPage:function(t){this.$emit("pagination",t)}}},i=(a("2f0c"),a("2877")),r=Object(i.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{small:t.small,background:t.background,total:t.total,layout:t.layout,"page-size":t.pageSize,"current-page":t.currentPage},on:{"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.handleClickPage}})],1)}),[],!1,null,null,null);e.a=r.exports},7361:function(t,e,a){},"7e93":function(t,e,a){}}]);